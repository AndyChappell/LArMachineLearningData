study_name: "2dclustering_W_example_study" # Name of this study
studies_dir: "/storage/epp2/phsajw/bondora/study_results" # Where to make the directory to put study outputs (DB and copy of config file)
study_storage_name: "Everything_W_importancerandomtop19_tp+tc.db" # Name of study db file
load_study: False # If true and 'study_storage_name' exists, the optimisation will continue from the last checkpoint

scratch_dir_path: "/storage/epp2/phsajw/bondora/scratch" # Scratch dir write temp files to
pandora_setup_path: "/storage/epp2/phsajw/pandora_2dclustering_build3/setup.sh" # Script to setup your pandora buid
pandora_interface_path: "/storage/epp2/phsajw/pandora_2dclustering_build3/LArReco/bin/PandoraInterface" # Pandora exe for your build area
pandora_geometry_path: "/storage/epp2/phsajw/pandora_2dclustering_build3/LArReco/geometry/PandoraGeometry_DUNEFD_1x2x6.xml" # Pandora geometry for your build area

pndr_data_path: "/storage/epp2/phsajw/datasets/dune10kt_1x2x6_v09_81_00d02_lbl_norollup_mixed/train" # Directory of pndrs

run_xml_path: "/storage/epp2/phsajw/bondora/LArMachineLearningData/scripts/bondora/settings/PandoraSettings_Master_DUNEFD.xml" # Pandora entry xml (_Master_) to use
default_algs_xml_path: "/storage/epp2/phsajw/bondora/LArMachineLearningData/scripts/bondora/settings/2d_clustering/PandoraSettings_Neutrino_DUNEFD_W.xml" # Pandora xml with explicit xml tags for config parameters you want to optimise

pandora_run_script_path: "/storage/epp2/phsajw/bondora/LArMachineLearningData/scripts/bondora/scripts/clustering_randomorder.sh" # Script for running pandora (takes care of some bookkeeping)
aggregate_validations_script_path: "/storage/epp2/phsajw/bondora/LArMachineLearningData/scripts/bondora/scripts/aggregate_validations_trackpuritycompleteness.sh" # Aggregate and extract average metrics from the validation ROOT files
result_parser: "track_purity_completeness" # Derived class in 'results_parsers.py' to convert aggregated metrics into a single objective value
sampler: "gp" # Type of sample: 'gp' is gaussian process (Bayesian Optimisation), 'random' is random sampling (calculating paramter importance)
n_processes: 2 # Number of parallel pandora processes
n_files_total: 2 # Number of files to process
expected_single_file_process_time: 30 # Used to define a cut off time for a pandora process
n_files_per_process: 1 # Number of .pndr files each pandora process runs on
sampler_seed: 1 # Seed to pass to the sampler

search_space: # Define the search space of the optimisation
  LArLongitudinalExtension/EmissionMaxLongitudinalDisplacement: # Name of config parameter in xml: algorithm type/xml tag
    - "float" # Type of config parameter
    - 7.5 # Lower bound of search
    - 22.5 #  Upper bound of search
    - null # Step size of search, null is continuous search space
  LArClusteringParent/LArTrackClusterCreation/MaxCaloHitSeparation: # 3 names is the max and means: algorithm type/algorithm type/xml tag
    - "float"
    - 0.7
    - 2.1
    - null
  LArTransverseAssociation/clusterAngle:
    - "float"
    - 22.5
    - 67.5
    - null
  LArKinkSplitting/MaxScatterCosTheta:
    - "float_cosangle" # The config param is actually a cos(theta), but we choose to define the search space in degrees
    - 12.5
    - 37.5
    - null
  LArBranchSplitting/MaxLongitudinalDisplacement:
    - "float"
    - 5.0
    - 15.0
    - null
  LArLongitudinalAssociation/MinCosRelativeAngle:
    - "float_cosangle"
    - 5.0
    - 15.0
    - null
  LArLongitudinalAssociation/MaxTransverseDisplacement:
    - "float"
    - 1.0
    - 3.0
    - null
  LArLongitudinalAssociation/MinClusterLayers:
    - "int"
    - 2
    - 6
    - null
  LArLayerSplitting/MaxScatterRms:
    - "float"
    - 0.17
    - 0.53
    - null
  LArLongitudinalExtension/EmissionMaxTransverseDisplacement:
    - "float"
    - 1.2
    - 3.8
    - null
  LArHitWidthClusterMerging/MaxConstituentHitWidth:
    - "float"
    - 0.2
    - 0.8
    - null
  LArLongitudinalExtension/NodeMaxCosRelativeAngle:
    - "float_cosangle"
    - 12.5
    - 37.5
    - null
  LArHitWidthClusterMerging/MaxZMergeDistance:
    - "float"
    - 1.0
    - 3.0
    - null
  LArLayerSplitting/MaxScatterCosTheta:
    - "float_cosangle"
    - 30.0
    - 90.0
    - null
  LArHitWidthClusterMerging/FittingWidth:
    - "float"
    - 10.0
    - 30.0
    - null
  LArOverShootSplitting/MaxIntersectDisplacement:
    - "float"
    - 0.7
    - 2.3
    - null
  LArLayerSplitting/MaxSlidingCosTheta:
    - "float_cosangle"
    - 15.0
    - 45.0
    - null
  LArTransverseExtension/MinClusterLength:
    - "float"
    - 0.2
    - 0.8
    - null
  LArKinkSplitting/SlidingFitHalfWindow:
    - "int"
    - 10
    - 30
    - null
n_trials: 3 # Number of trials including startup trials
n_startup_trials: 1 # Number of startup trials, these are random samples to "warm up" the Gaussian process
initial_param_point: # If not null, first config parameters to sample. I set this to the default parameters so impact of the optimisation can be easily analysed.
  LArLongitudinalExtension/EmissionMaxLongitudinalDisplacement: 15.0
  LArClusteringParent/LArTrackClusterCreation/MaxCaloHitSeparation: 1.4
  LArTransverseAssociation/clusterAngle: 45.0
  LArKinkSplitting/MaxScatterCosTheta: 25.176716940609722 # 0.905
  LArBranchSplitting/MaxLongitudinalDisplacement: 10.0
  LArLongitudinalAssociation/MinCosRelativeAngle: 9.936367072140724 # 0.985
  LArLongitudinalAssociation/MaxTransverseDisplacement: 2.0
  LArLongitudinalAssociation/MinClusterLayers: 4
  LArLayerSplitting/MaxScatterRms: 0.35
  LArLongitudinalExtension/EmissionMaxTransverseDisplacement: 2.5
  LArHitWidthClusterMerging/MaxConstituentHitWidth: 0.5
  LArLongitudinalExtension/NodeMaxCosRelativeAngle: 25.04169519299524 # 0.906
  LArHitWidthClusterMerging/MaxZMergeDistance: 2.0
  LArLayerSplitting/MaxScatterCosTheta: 60.0 # 0.5
  LArHitWidthClusterMerging/FittingWidth: 20.0
  LArOverShootSplitting/MaxIntersectDisplacement: 1.5
  LArLayerSplitting/MaxSlidingCosTheta: 30.002910931188026 # 0.866
  LArTransverseExtension/MinClusterLength: 0.5
  LArKinkSplitting/SlidingFitHalfWindow: 20
